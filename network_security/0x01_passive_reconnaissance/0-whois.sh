#!/bin/bash
whois "$1" | awk -F: 'function t(s){gsub(/^[ \t]+|[ \t]+$/,"",s);return s}/^Registrant /{s="Registrant"}/^(Admin |Administrative Contact)/{s="Admin"}/^(Tech |Technical Contact)/{s="Tech"}s&&/ Name:/{printf "%s Name, %s\n",s,t($2)}s&&/ Organization:/{printf "%s Organization, %s\n",s,t($2)}s&&/ Street:/{printf "%s Street, %s\n",s,t($2)}s&&/ City:/{printf "%s City, %s\n",s,t($2)}s&&/ State\/Province:/{printf "%s State/Province, %s\n",s,t($2)}s&&/ Postal Code:/{printf "%s Postal Code, %s\n",s,t($2)}s&&/ Country:/{printf "%s Country, %s\n",s,t($2)}s&&/ Phone:/&&!/Ext/{printf "%s Phone, %s\n",s,t($2)}s&&/ Phone Ext:/{printf "%s Phone Ext:, \n",s}s&&/ Fax:/&&!/Ext/{printf "%s Fax, \n",s}s&&/ Fax Ext:/{printf "%s Fax Ext:, \n",s}s&&/ Email:/{printf "%s Email, %s%s",s,t($2),NR?ORS:""}' > "$1.csv"
